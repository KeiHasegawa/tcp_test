このプログラムを Windows 10 で動作させた.

int soc = socket(...);

bind(soc, ...);

listen(soc, ...);

listen の呼び出しで

このアプリの機能のいくつかが
Windows DEfender ファイアウォール
でブロックされています

というダイアログボックスが表示される.

「アクセスを許可する」を押した.

次に実行したときに listen が成功するのかと思ったがやはり負の値が
返っている.

しかし, linux で動作させて再び Windows で動作させてみたところ
accept は成功している.

現状 Windows 版は

server 側も client 側も read でブロックしている.
試しに server 側で write を先にしてみたところ

errno = ENOTCONN

で fail している.

linux 版
現状 accept は成功しているが
read と write が期待しない動作になっている.

read は errno = ENOTCONN でエラーしているらしい

write の呼び出しで SIGPIPE を受けている.

htons や htonl を使用すると実は期待通り動作していない.
バイトオーダーを変更しないほうが実は期待通り動作している.

